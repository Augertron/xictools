#! /bin/sh
# $1 : the full path to the installation package
# $2 : the full path to the installation destination
# $3 : the mountpoint of the destination volume
# $4 : the root directory for the current System folder

prefix=$2

# The XicTools-4.3 package name
pkgname="xictools.wrspice"

# We assume safe-install is being used, so that we keep the prior
# installation in its entirety, so no need to back up config files.
# User has to update files by hand, which is probably not good.

# Back up config files
#cfgfiles="mozyrc \
#    news \
#    wrspice_mesg \
#    wrspiceinit"
#
#libdir=$prefix/xictools/wrspice.current
#for a in $cfgfiles; do
#    if [ -f $libdir/startup/$a ]; then
#        cp -pf $libdir/startup/$a $libdir/startup/$a.tmporig
#    fi
#done

# Do a manual un-install if an existing package is found, Apple's
# install system apparently doesn't do this.

dir_list=""
file_list=`pkgutil --files $pkgname 2>&1 > /dev/null`
if [ $? = 0 ]; then
    for a in $file_list; do
        if [ -d $prefix/$a ]; then
            dir_list="$prefix/$a $dir_list"
        else
            rm -f $prefix/$a
        fi
    done
    for a in $dir_list; do
        "rmdir $a 2>&1 > /dev/null"
    done
fi

# Remove links.
twrs=$prefix/xictools/wrspice
tbin=$prefix/xictools/bin
rm -f $twrs $tbin/multidec $tbin/proc2mod $tbin/printtoraw $tbin/wrspice \
  $tbin/wrspiced

