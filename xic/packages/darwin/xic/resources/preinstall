#! /bin/sh
# $1 : the full path to the installation package
# $2 : the full path to the installation destination
# $3 : the mountpoint of the destination volume
# $4 : the root directory for the current System folder

prefix=$2
libdir=$prefix/xictools/xic

# The Gen 4 package name
pkgname="XicTools.Xic.4"

# Back up config files
cfgfiles="device.lib \
    model.lib \
    mozyrc \
    xic_format_lib \
    xic_mesg \
    xic_stipples \
    xic_tech.hyp \
    xic_tech.scmos"

for a in $cfgfiles; do
    if [ -f $libdir/startup/$a ]; then
        cp -pf $libdir/startup/$a $libdir/startup/$a.tmporig
    fi
done

# Do a manual un-install if an existing package is found, Apple's
# install system doesn't do this.

dir_list=""
file_list=`pkgutil --files $pkgname 2>&1 > /dev/null`
if [ $? = 0 ]; then
    for a in $file_list; do
        if [ -d $prefix/$a ]; then
            dir_list="$prefix/$a $dir_list"
        else
            rm -f $prefix/$a
        fi
    done
    for a in $dir_list; do
        "rmdir $a 2>&1 > /dev/null"
    done
fi

